#!/bin/bash

# Script para configurar Android SDK para desenvolvimento

echo "ðŸ”§ Configurando Android SDK..."
echo ""

# Verificar se ANDROID_HOME estÃ¡ configurado
if [ -z "$ANDROID_HOME" ]; then
    echo "âš ï¸  ANDROID_HOME nÃ£o estÃ¡ configurado"
    echo "ðŸ“ Configurando ANDROID_HOME..."
    export ANDROID_HOME=/usr/lib/android-sdk
    export PATH=$PATH:$ANDROID_HOME/platform-tools:$ANDROID_HOME/tools
    
    # Adicionar ao .bashrc se nÃ£o existir
    if ! grep -q "ANDROID_HOME" ~/.bashrc 2>/dev/null; then
        cat >> ~/.bashrc << 'EOF'

# Android SDK Configuration
export ANDROID_HOME=/usr/lib/android-sdk
export PATH=$PATH:$ANDROID_HOME/platform-tools:$ANDROID_HOME/tools
EOF
        echo "âœ… ANDROID_HOME adicionado ao ~/.bashrc"
    fi
else
    echo "âœ… ANDROID_HOME jÃ¡ estÃ¡ configurado: $ANDROID_HOME"
fi

# Verificar se local.properties existe
if [ ! -f "android/local.properties" ]; then
    echo "ðŸ“ Criando android/local.properties..."
    mkdir -p android
    cat > android/local.properties << EOF
## This file is automatically generated by Android Studio.
# Do not modify this file -- YOUR CHANGES WILL BE ERASED!
#
# This file should *NOT* be checked into Version Control Systems,
# as it contains information specific to your local configuration.
#
# Location of the SDK. This is only used by Gradle.
sdk.dir=$ANDROID_HOME
EOF
    echo "âœ… android/local.properties criado"
else
    echo "âœ… android/local.properties jÃ¡ existe"
fi

# Verificar componentes do SDK
echo ""
echo "ðŸ” Verificando componentes do Android SDK..."
echo ""

if [ ! -d "$ANDROID_HOME/platforms" ]; then
    echo "âš ï¸  DiretÃ³rio 'platforms' nÃ£o encontrado"
    echo "   O SDK pode estar incompleto. VocÃª pode precisar instalar:"
    echo "   - Android SDK Platform (API 33 ou superior)"
    echo "   - Android SDK Build-Tools"
    echo ""
    echo "   OpÃ§Ãµes:"
    echo "   1. Instalar Android Studio e usar o SDK Manager"
    echo "   2. Usar o comando sdkmanager (se disponÃ­vel)"
    echo "   3. O Expo pode baixar automaticamente durante o build"
fi

if [ ! -d "$ANDROID_HOME/build-tools" ]; then
    echo "âš ï¸  DiretÃ³rio 'build-tools' nÃ£o encontrado"
fi

# Verificar dispositivos conectados
echo ""
echo "ðŸ“± Verificando dispositivos Android..."
echo ""
adb devices

echo ""
echo "âœ… ConfiguraÃ§Ã£o concluÃ­da!"
echo ""
echo "ðŸ“ Para usar em uma nova sessÃ£o de terminal, execute:"
echo "   source ~/.bashrc"
echo ""
echo "ðŸ’¡ Dica: Se vocÃª nÃ£o tem um dispositivo fÃ­sico conectado,"
echo "   vocÃª pode usar o Expo Go app ou criar um emulador."
